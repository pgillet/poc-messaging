# Export the VM
vagrant package vm.gz

# Extract (Do not overwrite the Vagrantfile!)
tar -xvf vm.gz -C /target/directory

# Import the bootable virtual disk into Google Cloud
gcloud beta compute images import centos-7-rabbitmq-server \
    --source-file centos7-rabbitmq-server.vmdk \
    --os centos-7



RabbitMQ post-installation steps

# Access control
# Create a RabbitMQ user called "meteofr"
rabbitmqctl add_user meteofr meteofr

# Create a new virtual host called "test"
rabbitmqctl add_vhost test

# Grant the user named "meteofr" access to the virtual host called "test", 
# with configure permissions on all resources whose names starts with "meteofr-", 
# and write and read permissions on all resources
rabbitmqctl set_permissions -p test meteofr "^meteofr-.*" ".*" ".*"

# Tag the user with "administrator" for full management UI and HTTP API access
rabbitmqctl set_user_tags meteofr administrator

# Delete the defaut guest user as a primary security measure
rabbitmqctl delete_user guest

